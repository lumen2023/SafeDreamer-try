Encoder CNN shapes: {}
Encoder MLP shapes: {'observation': (30,)}
Decoder CNN shapes: {}
Decoder MLP shapes: {'observation': (30,)}
想象SafeActorCritic--优化器
JAX devices (1): [CpuDevice(id=0)]
Policy devices: TFRT_CPU_0
Train devices:  TFRT_CPU_0
进入Agent train----
Tracing train function.

***世界模型模型训练***


***世界模型loss获取***


***世界模型loss获取***

Optimizer model_opt has 1,926,685 variables.
Backend TkAgg is interactive backend. Turning interactive mode on.
Optimizer actor_opt has 198,660 variables.
Optimizer critic_opt has 263,167 variables.
Optimizer critic_opt has 263,167 variables.
<class 'embodied.core.counter.Counter'>
Observation space:
  observation      Space(dtype=float32, shape=(30,), low=-inf, high=inf)
  reward           Space(dtype=float32, shape=(), low=-inf, high=inf)
  cost             Space(dtype=float32, shape=(), low=-inf, high=inf)
  crash            Space(dtype=bool, shape=(), low=False, high=True)
  is_first         Space(dtype=bool, shape=(), low=False, high=True)
  is_last          Space(dtype=bool, shape=(), low=False, high=True)
  is_terminal      Space(dtype=bool, shape=(), low=False, high=True)
Action space:
  action           Space(dtype=float32, shape=(2,), low=-1.0, high=1.0)
  reset            Space(dtype=bool, shape=(), low=False, high=True)
加载完模型后的步数：  Counter(0)
Did not find any checkpoint.
Writing checkpoint: logdir_osrp_lyz_0222_costlimit30/20250228-153716_osrp_vector_highway-fast_New-gym_safe-highway-fast-v0_0/checkpoint.ckpt
预填充--训练--数据集。
Wrote checkpoint: logdir_osrp_lyz_0222_costlimit30/20250228-153716_osrp_vector_highway-fast_New-gym_safe-highway-fast-v0_0/checkpoint.ckpt
per_episode step:  Counter(14)
per_episode step:  Counter(32)
per_episode step:  Counter(39)
per_episode step:  Counter(45)
per_episode step:  Counter(51)
per_episode step:  Counter(57)
per_episode step:  Counter(72)
per_episode step:  Counter(108)
per_episode step:  Counter(121)
per_episode step:  Counter(128)

avg_metrics记录到日志中记录成功

Train 10 episodes average: length 11.8, score -16.9, speed 24.9, , cost 4.8
per_episode step:  Counter(139)
per_episode step:  Counter(160)
per_episode step:  Counter(220)
per_episode step:  Counter(239)
per_episode step:  Counter(255)
per_episode step:  Counter(272)
per_episode step:  Counter(287)
per_episode step:  Counter(297)
per_episode step:  Counter(317)
per_episode step:  Counter(322)

avg_metrics记录到日志中记录成功

Train 10 episodes average: length 18.4, score -23.0, speed 25.1, , cost 4.8
per_episode step:  Counter(332)
per_episode step:  Counter(342)
per_episode step:  Counter(362)
per_episode step:  Counter(380)
per_episode step:  Counter(394)
per_episode step:  Counter(416)
per_episode step:  Counter(425)
per_episode step:  Counter(440)
per_episode step:  Counter(444)
per_episode step:  Counter(468)

avg_metrics记录到日志中记录成功

Train 10 episodes average: length 13.6, score -18.1, speed 25.0, , cost 4.8
per_episode step:  Counter(472)
per_episode step:  Counter(487)
per_episode step:  Counter(502)
per_episode step:  Counter(517)
per_episode step:  Counter(521)
per_episode step:  Counter(537)
per_episode step:  Counter(548)
per_episode step:  Counter(599)
per_episode step:  Counter(616)
per_episode step:  Counter(628)

avg_metrics记录到日志中记录成功

Train 10 episodes average: length 15.0, score -28.1, speed 24.3, , cost 4.8
per_episode step:  Counter(637)
per_episode step:  Counter(672)
per_episode step:  Counter(685)
per_episode step:  Counter(701)
per_episode step:  Counter(728)
per_episode step:  Counter(735)
per_episode step:  Counter(744)
per_episode step:  Counter(755)
per_episode step:  Counter(767)
per_episode step:  Counter(772)

avg_metrics记录到日志中记录成功

Train 10 episodes average: length 13.4, score -23.9, speed 24.2, , cost 4.8
per_episode step:  Counter(783)
per_episode step:  Counter(795)
per_episode step:  Counter(806)
per_episode step:  Counter(821)
per_episode step:  Counter(857)
per_episode step:  Counter(913)
per_episode step:  Counter(939)
per_episode step:  Counter(947)
per_episode step:  Counter(966)
per_episode step:  Counter(983)

avg_metrics记录到日志中记录成功

Train 10 episodes average: length 20.1, score -19.6, speed 25.4, , cost 4.8
per_episode step:  Counter(1000)
per_episode step:  Counter(1021)
Saved chunk: 20250228T153836F206684-4AvmnEJpnGTOl4H0jSQJGQ-2lHlNFJleDKQmoXUtMni4E-1024.npz
per_episode step:  Counter(1069)
per_episode step:  Counter(1086)
per_episode step:  Counter(1096)
per_episode step:  Counter(1109)
per_episode step:  Counter(1138)
per_episode step:  Counter(1179)
per_episode step:  Counter(1201)
per_episode step:  Counter(1209)

avg_metrics记录到日志中记录成功

Train 10 episodes average: length 21.6, score -29.5, speed 24.8, , cost 4.8
per_episode step:  Counter(1215)
per_episode step:  Counter(1239)
per_episode step:  Counter(1247)
per_episode step:  Counter(1264)
per_episode step:  Counter(1275)
